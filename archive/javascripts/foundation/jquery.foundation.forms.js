/*
 * jQuery Custom Forms Plugin 1.0
 * www.ZURB.com
 * Copyright 2010, ZURB
 * Free to use under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
*/
!function(t){var e=function(){return{tmp:[],hidden:null,adjust:function(e){var s=this;s.hidden=e.parents().andSelf().filter(":hidden"),s.hidden.each(function(){var e=t(this);s.tmp.push(e.attr("style")),e.css({visibility:"hidden",display:"block"})})},reset:function(){var e=this;e.hidden.each(function(s){var o=t(this),n=e.tmp[s];n===undefined?o.removeAttr("style"):o.attr("style",n)}),e.tmp=[],e.hidden=null}}};jQuery.foundation=jQuery.foundation||{},jQuery.foundation.customForms=jQuery.foundation.customForms||{},t.foundation.customForms.appendCustomMarkup=function(s){function o(e,s){var o=t(s).hide(),n=o.attr("type"),i=o.next("span.custom."+n);0===i.length&&(i=t('<span class="custom '+n+'"></span>').insertAfter(o)),i.toggleClass("checked",o.is(":checked")),i.toggleClass("disabled",o.is(":disabled"))}function n(s,o){var n,i=e(),d=t(o),a=d.next("div.custom.dropdown"),c=a.find("ul"),l=(a.find(".current"),a.find(".selector"),d.find("option")),r=l.filter(":selected"),u=0,m="",h=!1;if(!d.hasClass("no-custom")){if(0===a.length){var f=d.hasClass("small")?"small":d.hasClass("medium")?"medium":d.hasClass("large")?"large":d.hasClass("expand")?"expand":"";a=t('<div class="'+["custom","dropdown",f].join(" ")+'"><a href="#" class="selector"></a><ul /></div>"'),a.find(".selector"),c=a.find("ul"),m=l.map(function(){return"<li>"+t(this).html()+"</li>"}).get().join(""),c.append(m),h=a.prepend('<a href="#" class="current">'+r.html()+"</a>").find(".current"),d.after(a).hide()}else m=l.map(function(){return"<li>"+t(this).html()+"</li>"}).get().join(""),c.html("").append(m);a.toggleClass("disabled",d.is(":disabled")),n=c.find("li"),l.each(function(e){this.selected&&(n.eq(e).addClass("selected"),h&&h.html(t(this).html()))}),c.css("width","inherit"),a.css("width","inherit"),a.is(".small, .medium, .large, .expand")||(a.addClass("open"),i.adjust(c),u=n.outerWidth()>u?n.outerWidth():u,i.reset(),a.removeClass("open"),a.width(u+18),c.width(u+16))}}var i={disable_class:"js-disable-custom"};s=t.extend(i,s),t("form.custom input:radio[data-customforms!=disabled]").each(o),t("form.custom input:checkbox[data-customforms!=disabled]").each(o),t("form.custom select[data-customforms!=disabled]").each(n)};var s=function(e){var s=0,o=e.next();$options=e.find("option"),o.find("ul").html(""),$options.each(function(){$li=t("<li>"+t(this).html()+"</li>"),o.find("ul").append($li)}),$options.each(function(e){this.selected&&(o.find("li").eq(e).addClass("selected"),o.find(".current").html(t(this).html()))}),o.removeAttr("style").find("ul").removeAttr("style"),o.find("li").each(function(){o.addClass("open"),t(this).outerWidth()>s&&(s=t(this).outerWidth()),o.removeClass("open")}),o.css("width",s+18+"px"),o.find("ul").css("width",s+16+"px")},o=function(t){var e=t.prev(),s=e[0];!1===e.is(":disabled")&&(s.checked=!s.checked,t.toggleClass("checked"),e.trigger("change"))},n=function(t){var e=t.prev(),s=e.closest("form.custom"),o=e[0];!1===e.is(":disabled")&&(s.find('input:radio[name="'+e.attr("name")+'"]').next().not(t).removeClass("checked"),t.hasClass("checked")||t.toggleClass("checked"),o.checked=t.hasClass("checked"),e.trigger("change"))};t(document).on("click","form.custom span.custom.checkbox",function(e){e.preventDefault(),e.stopPropagation(),o(t(this))}),t(document).on("click","form.custom span.custom.radio",function(e){e.preventDefault(),e.stopPropagation(),n(t(this))}),t(document).on("change","form.custom select[data-customforms!=disabled]",function(){s(t(this))}),t(document).on("click","form.custom label",function(e){var s,i,d=t("#"+t(this).attr("for")+"[data-customforms!=disabled]");0!==d.length&&("checkbox"===d.attr("type")?(e.preventDefault(),s=t(this).find("span.custom.checkbox"),o(s)):"radio"===d.attr("type")&&(e.preventDefault(),i=t(this).find("span.custom.radio"),n(i)))}),t(document).on("click","form.custom div.custom.dropdown a.current, form.custom div.custom.dropdown a.selector",function(e){var s=t(this),o=s.closest("div.custom.dropdown"),n=o.prev();if(e.preventDefault(),t("div.dropdown").removeClass("open"),!1===n.is(":disabled"))return o.toggleClass("open"),o.hasClass("open")?t(document).bind("click.customdropdown",function(){o.removeClass("open"),t(document).unbind(".customdropdown")}):t(document).unbind(".customdropdown"),!1}),t(document).on("click","form.custom div.custom.dropdown li",function(e){var s=t(this),o=s.closest("div.custom.dropdown"),n=o.prev(),i=0;e.preventDefault(),e.stopPropagation(),t("div.dropdown").removeClass("open"),s.closest("ul").find("li").removeClass("selected"),s.addClass("selected"),o.removeClass("open").find("a.current").html(s.html()),s.closest("ul").find("li").each(function(t){s[0]==this&&(i=t)}),n[0].selectedIndex=i,n.trigger("change")}),t.fn.foundationCustomForms=t.foundation.customForms.appendCustomMarkup}(jQuery);